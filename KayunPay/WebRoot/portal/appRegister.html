<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>注册</title>
		<link href="/portal/iconfont/iconfont.css" type="text/css" rel="stylesheet" />
		<style type="text/css">
			*{padding:0; margin:0;}
			body {width: 100%;height: 100%;margin: 0px;padding: 0px; background:#fff;}
			ul, ol, li {list-style: none;}
			:focus {outline: 0;}
			a { color: #000;text-decoration: none;}
			img { border: 0;}
			i { font-style: normal;}
			table { border-collapse:collapse;}
			
			.header{ margin-top:6%; overflow: hidden;}
			.return{ width: 10%; float: left; color: #ccc; text-align: center; }
			.logo{ width:100%; float: left; display: table;}
			.logo img{ width:40%; margin:0 auto; display: -webkit-box;}
			.main{ margin-top:6%;}
			.list{ width: 95%;  height:18px; margin:0 auto; border-bottom:1px solid #e5e5e5; display: flex; padding:15px 0;}
			.list i{ margin-left:10px; text-align: center; float: left; color: #999;}
			.nametxt,.phonetxt,.pawtxt,.pawtxts,.namephone,.codetxt,.codepic{ width:85%; float: left; border:none; padding:inherit; margin:-15px 0 -15px 15px;}
			.codetxt,.codepic{ width:59%; float: left; border:none; padding:inherit; margin:-15px 0 -15px 25px;}
			.codebtn{ width:71%; float: left; margin-top:-5px;}
			.codebtn i{ width:60%; text-align: center; cursor: pointer; font-size: 0.5em; color: #3187fe; border-radius: 25px; background:#fff; border:1px solid #3187fe; padding:5px;}
			.codebtn b{  font-size:13px; line-height:28px;}
			.list p{ font-size:0.7em;}
			::-webkit-input-placeholder { height:1.5em; font-size: 0.7rem; color: #717171;}
			:-moz-placeholder { height:1.5em; font-size: 0.7rem; color: #717171;}/* Firefox 18- */
			::-moz-placeholder{ height:1.5em; font-size: 0.7rem; color: #717171;}/* Firefox 19+ */ 
			:-ms-input-placeholder { height:1.5em; font-size: 0.7rem; color: #717171;}
			.submit{ display: block; color: #fff; width: 95%; margin:0 auto; background:#ea4543; border-radius: 25px; text-align: center; padding:10px 0; margin-top:6%;}
			.popTips{ display:none;  position: fixed; z-index:2003; width:100%; height: 100%; top:0; left:0; bottom: 0;  text-align: center;  color: #fff;  background-color: rgba(255, 255 ,255 ,0);}
			.popTips-section{position: relative;width: 50%;height: auto; left: 50%; top: 50%;-webkit-transform: translate(-50%, -50%);background-color: rgba(0, 0 ,0 ,0.7);border-radius: 5px;}
			.popTips-section p{margin: 0; padding:15px 0;font-size: 12px;}
			.popTipSuc{color:#fff;}
			.popTipErr{color:#fff;}
			.confirm_pay{ width:64%;position:absolute;z-index:2003;border-radius:10px;background:#fff;padding:13px; left:50%!important; top:50%!important; margin-left:-32%;}
			.pay_del{height:20px;margin:10px 0 0 0;}
			.pay_del .del{margin-right: 10px; margin-bottom:6px; float: right; width: 13px; height: 13px; background: url(/portal/images/big_close.png); cursor: pointer;}
			.pay_row img{width:70px;vertical-align:middle;display:inline-block;}
			.pay_row label{display:inline-block;text-align:right;font-size:14px;}
			.pay_row #txtYZM{width:63px;border: 1px solid #ddd;height: 24px; margin-right:5px;}
			.pay_row button{cursor: pointer;background:#EB4F38;width:80px;height:30px;color:#fff;border:none;border-radius:3px;margin:8px auto 10px; display:-webkit-box;}
			.yinyingTop {display: none;position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background: #000000;opacity: 0.7;-ms-opacity: 0.7;-o-opacity: 0.7;-webkit-opacity: 0.7;-moz-opacity: 0.7;z-index:2002;}
			.disabled{background-color: #e6e6e6 !important; border-color: #e6e6e6 !important; color: #a6acb0 !important;}	
		</style>
		<script src="/portal/js/pub/jquery-1.7.1.min.js" type="text/javascript"></script>
		<script src="/portal/js/pub/core.js" type="text/javascript"></script>
		<script src="/portal/js/public.js" type="text/javascript"></script>
		<script type="text/javascript" src="/portal/js/config.js"></script>
	</head>
	<body>
		<div class="header">
			<!-- <a href="#" class="return fa fa-angle-left fa-2x"></a> -->
			<div class="logo"><img src="/portal/images/activity/logo.jpg" /></div>
		</div>
		<div class="main">
			<form>
				<div class="list">
					<i class="iconfont icon-name"></i>
					<input type="text" value="" placeholder="昵称" class="nametxt">
				</div>
				<div class="list">
					<i class="iconfont icon-phone"></i>
					<input type="number" value="" placeholder="手机号码" class="phonetxt">
				</div>
				<div class="list">
					<i class="iconfont icon-pwd"></i>
					<input type="password" value="" placeholder="登录密码" class="pawtxt">
				 </div>
				<div class="list">
					<i class="iconfont icon-pwd"></i>
					<input type="password" value="" placeholder="确认密码" class="pawtxts">
				</div>
				<div class="list">
					<i class="iconfont icon-phone"></i>
					<input type="text" value="" placeholder="推荐人手机/邀请码(选填)" class="namephone">
				</div>
				<div class="list">
					<i class="iconfont icon-code"></i>
					<input type="text" value="" placeholder="验证码" class="codetxt">
					<div class="codebtn">
						<i id="sendMsgBtn" sendToggle="0">获取验证码</i>
						<b id="msgCounter"></b>
					</div>			
				</div>
				<a href="javascript:;" class="submit">注册领518红包</a>
			</form>
		</div>
	</body>
	<script>
		$(function(){
			var urltxt=location.search;  //获取url中“？”符后面的字符串
			var codetxt=urltxt.substr(3,6);
			$(".namephone").val(codetxt);

			//发送验证码
			 $('#sendMsgBtn').click(function(){
				if( $(".phonetxt").val().length == 11 ){
					captchaApiV2(function( capVal ){
						$('#sendMsgBtn').sendMsg({
							"msgCounter" : "#msgCounter",
							"type"       : "0",
							"urPhone"    : $(".phonetxt").val(),
							"url"		 : "nSendMsgMobile",
							"cv"		 : capVal
						});
					});
				}else{
					$.popTips("popTipErr","请认真填写您的手机号码!") ;
				}
			});
			
			
			//注册按钮
			$(".submit").click(function(){
				var userName=$(".nametxt").val();  //昵称
				var userMobile=$(".phonetxt").val();  //手机号码
				var loginPasswd=$(".pawtxt").val();  //密码
				var loginPasswds=$(".pawtxts").val();  //确认密码  
				var uCheckCode=$(".codetxt").val();  //验证码
				var numRule = new RegExp("^[0-9]*$") ;
				var inviteCode=$(".namephone").val();
				
				if( userName.length < 2 ){
					$.popTips("popTipErr","昵称须为2~10个字");
					return false;
				}
				else if (numRule.test(userName)) {
					$.popTips("popTipErr","昵称不能全为数字") ;
					return false;
				}
				else if( userMobile.length == 0 || userMobile.length != 11 ){
					$.popTips("popTipErr","请输入11位数字有效手机号!");
					return false ;
				}
				else if( loginPasswd.length < 6 ){
					$.popTips("popTipErr","请输入6位以上的密码!") ;
					return false ;
				}
				else if( loginPasswd != loginPasswds){
					$.popTips("popTipErr","确认密码不匹配!") ;
					return false ;
				}
				else if( uCheckCode.length == 0 || uCheckCode.length > 6){
					$.popTips("popTipErr","验证码不正确!") ;
					return false ;
				}
				
				if(inviteCode.length==11 || numRule.test(inviteCode)){
					if(inviteCode==userMobile){
						$.popTips("popTipErr","推荐人不能为自己!") ;
						return false ;
					}
				}
				
				YRHX.ajax({
					url:"/mRecommendRegister",
					//dataType:"jsonp",
					data:{
						userName : userName,
						userMobile : userMobile,
						loginPasswd : loginPasswd,
						uCheckCode : uCheckCode,
						inviteCode : inviteCode
					},
					success:function(data){
						window.location.href="/appDownload";
					},
					error : function(errData ){
						 $.popTips("popTipSuc",errData.return_info,function(){
						 }) ;
					}
				});
			});

		});

	</script>
</html>
