<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>借款合同生成工具</title>
<link type="text/css" href="/portal/css/public.css" rel="stylesheet">
<link type="text/css" href="/portal/css/user.css" rel="stylesheet">
<link type="text/css" href="/portal/css/datapicker/datepicker.css" rel="stylesheet">
<!--[if lt IE 9]><script src="/portal/js/html5shiv.min.js"></script><![endif]-->
<style>
	.myInfo .item{
		padding-left:10px;
	}
</style>
</head>
<body>
	<div class="wrapper">
		<div style="height: 100px;font-size: 64px;text-align: center;">
			<font>易融恒信V587</font>
		</div>
		<main class="user">
		<div class="user-main">
			<div class="user-main-right" style="width: 100%">
				<div class="user-main-right-c">
					<div class="tabNav">
						<ul>
							<li class="active">借款合同生成器</li>
						</ul>
					</div>

					<div id="tab-content">
						<div class="tab-content-list myInfo">
							<div class="item" id="divTransferUser">
								<div class="write_text">
									<label><i>*</i>债权人&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label>
										<div class="select" style="width:270px;margin-left:16px;z-index: 10">
										<span id="transferFirstUser" style="margin-left:0px;"> </span>
										<div class="options" id="optTransferUser" style="height:300px; overflow:auto;">
										</div>
									</div>
								</div>
							</div>
							<div class="item" id="transferUser"><label><i>*</i>债权人&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</i></label><input type="text" id="transferUserInfo" readonly="readonly"></div>
							<!-- <div class="item"><label><i>*</i>合同编号&nbsp;&nbsp;&nbsp;：</label><input type="text" id="contractsNum" readonly="readonly"/></div> -->
							<div class="item"><label><i>*</i>签订时间&nbsp;&nbsp;&nbsp;：</label><input class="time_input" type="text" id="loanDate"/></div>
							<div class="item">
								<div class="write_text">
									<label><i>&nbsp;&nbsp;</i>合同类型&nbsp;&nbsp;&nbsp;：</label>
									<div id="divTemplateType" class="select" style="width:100px;margin-left:16px;">
										<span id="spanTemplateType" style="margin-left:0px;" templateType='GPS等额本息' >GPS等额本息</span>
										<div class="options" id="templateType">
											<a href='javascript:' templateType='GPS等本等息'>GPS等额本息</a>
											<!-- <a href='javascript:' templateType='GPS先息后本'>GPS先息后本</a> -->
											<a href='javascript:' templateType='质押等本等息'>质押等额本息</a>
											<!-- <a href='javascript:' templateType='质押先息后本'>质押先息后本</a> -->
										</div>
									</div>
								</div>
							</div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>客服专号&nbsp;&nbsp;&nbsp;：</label><input type="text" id="serveMobile" value="400 027 0707" maxlength=11/></div>
							<div class="dashedLine"></div>
							
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款人类型：
								<input type="radio" value="0" name="loanUserType" checked="checked" id="loanUserType_personal" /><label for="loanUserType_personal">&nbsp;个人用户</label>
								<input type="radio" value="1" name="loanUserType" id="loanUserType_company" /><label for="loanUserType_company">&nbsp;企业用户</label></label>
							</div>
							<div class="item"><label id="txtLoanUserName"><i>*</i>借款人姓名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="loanUserName"/><font color="red"> &nbsp;&nbsp;(多个名字使用顿号分割","，如：****,****)</font></div>
							<div class="item"><label id="txtLoanUserCardId"><i>*</i>借款人身份证&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="loanUserCardId" maxlength=18/><font color="red">&nbsp;&nbsp;(多个身份证使用顿号分割","，如：****,****)</font></div>
							<div id="txtLegal" class="item" style="display: none;"><label id="txtLegalUserCardId"><i>*</i>法人身份证&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="legalUserCardId" maxlength=18/></div>
							<div id="loanType" class="item" style="display: none;"><label id="txtLegalUserCardId"><i>*</i>借款用户类型&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="loanTypeForUser" value="个人用户" maxlength=18/></div>
							
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款人家庭住址&nbsp;&nbsp;&nbsp;：</label><input type="text" maxlength=30 id="loanUserAddress"/></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款人手机号&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="loanUserMobile" maxlength=11/></div>
							<div class="dashedLine"></div>
							 
							<div class="item"><label><i>*</i>借款金额&nbsp;&nbsp;&nbsp;：</label><input type="text" id="loanAmount" onkeyup="this.value=this.value.replace(/\D/g,'')"  onafterpaste="this.value=this.value.replace(/\D/g,'')"/></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>现金支付&nbsp;&nbsp;&nbsp;：</label><input type="text" id="moneyLoan"/>&nbsp;&nbsp;&nbsp;&nbsp;<font color="red">(若未使用现金支付，则不填)</font></div>
							<div class="item"><label><i>*</i>借款利率&nbsp;&nbsp;&nbsp;：</label><input type="text" id="rateByMonth" maxlength=6/>&nbsp;&nbsp;%&nbsp;&nbsp;<font color="red">(实际借款月利率、固定利率，如：2.5%则输入2.5即可)</font></div>
							<div class="item"><label><i>*</i>月服务费率&nbsp;&nbsp;&nbsp;：</label><input type="text" id="rateByService" maxlength=6/>&nbsp;&nbsp;%&nbsp;&nbsp;<font color="red">(2.5%则输入2.5即可)</font></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>综合利率&nbsp;&nbsp;&nbsp;：</label><input type="text" id="rateBySynthesize" maxlength=6/>&nbsp;&nbsp;%&nbsp;&nbsp;<font color="red">(如：2.5%则输入2.5即可)</font></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款用途&nbsp;&nbsp;&nbsp;：</label><input type="text" maxlength=20 id="loanUsed"/></div>
							<div class="item"><label><i>*</i>借款期限&nbsp;&nbsp;&nbsp;：</label><input type="text" id="limit" maxlength=3 style="width:80px;" onkeyup="this.value=this.value.replace(/\D/g,'')"  onafterpaste="this.value=this.value.replace(/\D/g,'')"/><font color="red">&nbsp;&nbsp;(如：3个月则输入3即可)</font></div>
							
                            <div class="item"><label><i>&nbsp;&nbsp;</i>一次融资服务费&nbsp;&nbsp;&nbsp;：</label><input type="text" id="sumFinancingMoney" /></div>
                            <div class="item"><label><i>&nbsp;&nbsp;</i>融资服务费&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="financingMoney" /></div>
                            <div class="item"><label><i>&nbsp;&nbsp;</i>手续费&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="fee" /></div>
                            <div class="item"><label><i>&nbsp;&nbsp;</i>担保费&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="guaranteeFee" /></div>
                            <div class="item"><label><i>&nbsp;&nbsp;</i>杂费&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="incidentals" /></div>
                            <!-- <div class="item"><label><i>&nbsp;&nbsp;</i>押金&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="detailMoney" /></div> -->
                            <div class="item"><label><i>&nbsp;&nbsp;</i>其它费用&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="otherMoney" /></div>
                            <div class="item"><label><i>&nbsp;&nbsp;</i>首次款卡姓名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：</label><input type="text" id="entrustPersonName" /></div>
							<div class="item">
									<label style="margin-right:23px"><i>&nbsp;&nbsp;</i>车辆信息&nbsp;&nbsp;：</label>品牌：<input type="text" maxlength=10 style="width:60px;margin-left: 0px;margin-right: 10px;" id="car_pp"/>型号：<input type="text" maxlength=10 style="width:80px;margin-left: 0px;margin-right: 10px;" id="car_xh"/>车牌号：<input type="text" maxlength=7 style="width:80px;margin-left: 0px;margin-right: 10px;" id="car_cph"/>发动机号：<input type="text" maxlength=20 style="width:120px;margin-left: 0px;margin-right: 10px;" id="car_fdjh"/>车架号：<input type="text" maxlength=20 style="width:150px;margin-left: 0px;margin-right: 10px;" id="car_cjh"/>
									<a href='javascript:' id="a_addCars" class="green">添加</a>
									<a href='javascript:' id="a_delCars" class="red">删除</a>
							</div>
							<div id="carsDiv"></div>
							<div class="dashedLine"></div>
							<!-- 
							<div class="item"><label><i>*</i>银行卡姓名：</label><input type="text" id="loanBankUserName"/></div>
							 -->
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款人银行卡卡号：</label><input type="text" maxlength=19 id="loanBankNo"/></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>借款人银行卡全称&nbsp;&nbsp;&nbsp;：</label><input maxlength=20 type="text" id="loanBankName"/></div>
							<!-- 
							<div class="dashedLine"></div>
							<div class="item"><label><i>*</i>紧急联系人姓名：</label><input type="text" id="emergencyName"/></div>
							<div class="item"><label><i>*</i>紧急联系人关系：</label><input type="text" id="emergencyRelation"/></div>
							<div class="item"><label><i>*</i>紧急联系人手机：</label><input type="text" id="emergencyMobile"/></div>
							 -->
							<div class="dashedLine"></div>
							<div style="margin-left: 40px;color: red;">备注：如果有担保人，姓名必须填写，其它可选填！</div>
							<div class="item">
								<label style="margin-right:23px">
									<i>&nbsp;&nbsp;</i>担保人(公司)&nbsp;&nbsp;：
								</label>
								姓名：<input type="text" maxlength=20 style="width:60px;margin-left: 0px;margin-right: 10px;" id="ensureCompanyName"/>
								公司组织机构代码：<input type="text" maxlength=20 style="width:120px;margin-left: 0px;margin-right: 10px;" id="companyCode"/>
								经营场所：<input type="text" maxlength=30 style="width:260px;margin-left: 0px;margin-right: 10px;" id="businessPlace"/>
								联系电话：<input type="text" maxlength=11 style="width:90px;margin-left: 0px;margin-right: 10px;" id="companyPhone"/>
							</div>
							<div class="item">
								<label style="margin-right:23px">
									<i>&nbsp;&nbsp;</i>担保人(个人)&nbsp;&nbsp;：
								</label>
								姓名：<input type="text" maxlength=20 style="width:60px;margin-left: 0px;margin-right: 10px;" id="dbr_xm"/>
								身份证号：<input type="text" maxlength=18 style="width:130px;margin-left: 0px;margin-right: 10px;" id="dbr_sfzh"/>
								联系电话：<input type="text" maxlength=11 style="width:80px;margin-left: 0px;margin-right: 10px;" id="dbr_lxdh"/>
								住所：<input type="text" maxlength=30 style="width:300px;margin-left: 0px;margin-right: 10px;" id="dbr_zs"/>
								<a href='javascript:' id="a_addDbr" class="green">添加</a>
								<a href='javascript:' id="a_delDbr" class="red">删除</a>
							</div>
							<div id="dbrDiv"></div>
							<div class="dashedLine"></div>
							<div style="margin-left: 40px;color: red;">违约条款：</div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>收车费用标准：</label><input type="text" maxlength=20 id="companyAddress" style="width:200px;"/>&nbsp;之内5000元起步，之外10000元起步</div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>合同签署地：</label><input type="text" maxlength=30 id="addressSign"/></div>
							<div class="item"><label><i>&nbsp;&nbsp;</i>合同签署地法院：</label><input type="text" value="武汉市江汉区" maxlength=30 id="court"/>&nbsp;人民法院</div>
							<div class="dashedLine"></div>
							<form id="vehicleForm" action="/addContracts" method="post">
								<!-- 
								<div class="item"><label><i>*</i>是否担保&nbsp;&nbsp;&nbsp;：</label>
									<input type="radio" name="isdanbao" value="1" />是
									<input type="radio" name="isdanbao" value="0" checked="checked"/>否
								</div>
								 -->
								<input type="hidden" name="transferUserNo"><!-- 债权人标码 -->
								<input type="hidden" name="contractsNum"><!-- 合同编号 -->
								<input type="hidden" name="loanUserName"><!-- 借款人姓名 -->
								<input type="hidden" name="loanUserCardId"><!-- 借款人身份证号 -->
								<input type="hidden" name="loanUserAddress"><!-- 家庭住址 -->
								<input type="hidden" name="loanUserMobile"><!-- 手机号 -->
								<!-- <input type="hidden" name="emergencyName">紧急联系人姓名
								<input type="hidden" name="emergencyRelation">紧急联系人关系
								<input type="hidden" name="emergencyMobile">紧急联系人手机 -->
								<input type="hidden" name="loanAmount"><!-- 借款金额 -->
								<input type="hidden" name="moneyLoan"/><!-- 现金支付 -->
								<input type="hidden" name="rateByMonth"><!-- 借款利率 -->
								<input type="hidden" name="rateBySynthesize"/><!-- 综合利率 -->
								<input type="hidden" name="loanUsed"><!-- 借款用途 -->
								<input type="hidden" name="limit"><!-- 借款期限 -->
								<input type="hidden" name="cars"><!-- 汽车信息 -->
								<!-- <input type="hidden" name="loanBankUserName">银行卡姓名 -->
								<input type="hidden" name="loanBankNo"><!-- 银行卡卡号 -->
								<input type="hidden" name="loanBankName"><!-- 银行全称 -->
								<input type="hidden" name="loanDate"><!-- 签订时间 -->
								<input type="hidden" name="dbrs"><!-- 担保人(个人) -->
								
								<input type="hidden" name="ensureCompanyName"><!-- 担保人姓名(公司) -->
								<input type="hidden" name="companyCode"><!-- 担保人公司组织机构代码(公司) -->
								<input type="hidden" name="businessPlace"><!-- 担保人经营场所(公司) -->
								<input type="hidden" name="companyPhone"><!-- 担保人联系电话(公司) -->
								
								<input type="hidden" name="templateType"/><!-- 合同类型 -->
								<input type="hidden" name="serveMobile"/><!-- 客服专号 -->
								<input type="hidden" name="companyAddress"/><!-- 收车费用标准 -->
								<input type="hidden" name="addressSign"/><!-- 合同签署地 -->
								<input type="hidden" name="court"/><!-- 合同签署地法院 -->
								
								<input type="hidden" name="sumFinancingMoney"><!--一次 融资服务费 -->
								<input type="hidden" name="financingMoney"><!-- 融资服务费 -->
								<input type="hidden" name="fee"><!-- 手续费 -->
								<input type="hidden" name="guaranteeFee"><!-- 担保费 -->
								<input type="hidden" name="incidentals"><!-- 杂费 -->
								<!-- <input type="hidden" name="detailMoney">押金 -->
								<input type="hidden" name="otherMoney"><!-- 其它费用 -->
								<input type="hidden" name="entrustPersonName"><!-- 首次款卡姓名 -->
								<input type="hidden" name="rateByService"><!-- 月服务费率 -->
								<input type="hidden" name="legalUserCardId"><!-- 法人身份证 -->
								<input type="hidden" name="loanTypeForUser"><!-- 用户类型  -->
								<div class="item buttonP"><button type="button" class="save" id="saveInfoBtn">保存</button></div><!-- <button type="reset" class="reset">修改</button> -->
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		</main>
		<footer id="aaa" class="footer"></footer>
	</div>
<script type="text/javascript" src="/portal/js/pub/jquery-1.7.1.min.js"></script>
<script type="text/javascript" src="/portal/js/pub/core.js"></script>
<script type="text/javascript" src="/portal/js/config.js"></script>
<script type="text/javascript" src="/portal/js/public.js"></script>
<script type="text/javascript">window.userNavActive = 11;topNavSelect= '4'; </script>
<script type="text/javascript" src="/portal/js/user.js"></script>
<script type="text/javascript" src="/portal/js/pub/widget-table.js"></script>
<script type="text/javascript" src="/portal/js/pub/app.js"></script>
<script type="text/javascript" src="/portal/css/datapicker/bootstrap-datepicker.js"></script>
<script>
	//初始化查询数据
	$('.time_input').datepicker({
		'format':'yyyy-mm-dd'
	});
	
	var date = new Date();
	var year = date.getFullYear();
	var month = date.getMonth()+1 ;
	var day = date.getDate();
	$('#loanDate').val(year + "-" + (month > 9 ? month : "0"+ month) + "-" + (day > 9 ? day : "0"+day));
	
	$("input[name=loanUserType]").click(function() {
		if ($(this).val() == 0) {
			$("#txtLoanUserName").html("<i>*</i>姓名&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：");
			$("#txtLoanUserCardId").html("<i>*</i>借款人身份证&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：");
			$("#txtLegal").css('display','none');
			$("#loanTypeForUser").val("个人用户");
		} else if ($(this).val() == 1) {			
			$("#txtLoanUserName").html("<i>*</i>借款人&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;：")
			$("#txtLoanUserCardId").html("<i>*</i>企业代码&nbsp;&nbsp;：");	
			$("#txtLegal").css('display','block');
			$("#loanTypeForUser").val("企业用户");

		}
	})
	
	// 初始化债权人信息
	YRHX.ajax({
		url : "/getOPUserInfo",
		data : {},
		success : function( sucData ) {
			YRHX.ajax({
				url : "/queryTransferById",
				data : {
					"transferUserNo" : sucData.opUser.transferUserNo
				},
				success : function( sucData ) {
					if (sucData != null) {	// 显示债权人信息
						$("#transferUserInfo").val(sucData.name + "     " + sucData.area);
						$("input[name='transferUserNo']").val(sucData.transferUserNo);
						$("#transferUser").show();
						$("#divTransferUser").hide();
					} else {	// 账号未绑定债权人，显示全部债权人
						$("#transferUser").hide();
						$("#divTransferUser").show();
						//查询债权人列表
						YRHX.ajax({
						    url: "queryTransferUserV2",
						    success: function (sucData) {
								var transferUserHtml = "";
						    	if(sucData){
									for (var i = 0; i < sucData.length; i++) {
										if(i < 1 ){
											$("#transferFirstUser").html( sucData[i].name + "&nbsp;&nbsp;&nbsp;&nbsp;" + sucData[i].area);
											$("#transferFirstUser").attr("transferUserNo",sucData[i].transferUserNo);
										}
										transferUserHtml += "<a href='javascript:' transferUserNo ='"+ sucData[i].transferUserNo +"'>"+ sucData[i].name + "&nbsp;&nbsp;&nbsp;&nbsp;" + sucData[i].area +"</a>";
									}
									
									$("#optTransferUser").html( transferUserHtml );
									$('#optTransferUser a').click(function(){
										var html = $(this).html();
										var transferUserNo = $(this).attr("transferUserNo");
										var value = html;
										var selectElement = $(this).parent().parent();
										if($(this).attr('value')){
											value = $(this).attr('value');
										}
										selectElement.children('span').html(html);
										selectElement.children('span').attr("transferUserNo",transferUserNo);
										$(this).parent().hide();
									});
								}
						    },
						    error: function (errData) {
						    	$.popTips("popTipErr",errData.return_info);
						    }
						});
					}
				},
				error : function( errorData ){
					$("#divTransferUser").show();
				}
			});
		},
		error : function( errorData ){
			$.popTips("popTipErr",errorData.return_info || "获取信息失败");
		}
	});
	
	//合同编号
	/* YRHX.ajax({
		url : "/generateContractNo",
		success : function(sucData) {
			$("#contractsNum").val(sucData);
		},
		error : function(errData) {
			
		}
	}); */
	
	//合同类型
	$("#templateType a").click(function(){
		var html = $(this).html();
		var contractTemplate = $(this).attr("templateType");
		var value = html;
		var selectElement = $(this).parent().parent();
		if ($(this).attr("value")) {
			value = $(this).attr("value");
		}
		selectElement.children("span").html(html);
		selectElement.children("span").attr("templateType", contractTemplate);
		$(this).parent().hide();
	});
		
	//汽车信息
	$("#a_addCars").click(function(){
		 var item = $("#carsDiv > div");
		 var carLength = item.length + 1;
		 var carsHtml = '<div id="carItem_'+ carLength +'" class="item" carsDiv="carsDiv"><label style="margin-right:23px"><i>*</i>车辆信息&nbsp;&nbsp;：</label>品牌：<input type="text" maxlength=10 style="width:60px;margin-left: 0px;margin-right: 10px;" id="car_pp_' + carLength;
		 carsHtml += '"/>型号：<input type="text" maxlength=10 style="width:80px;margin-left: 0px;margin-right: 10px;" id="car_xh_'+carLength;
		 carsHtml += '"/>车牌号：<input type="text" maxlength=7 style="width:80px;margin-left: 0px;margin-right: 10px;" id="car_cph_'+carLength;
		 carsHtml += '"/>发动机号：<input type="text" maxlength=20 style="width:120px;margin-left: 0px;margin-right: 10px;" id="car_fdjh_'+carLength;
		 carsHtml += '"/>车架号：<input type="text" maxlength=20 style="width:150px;margin-left: 0px;margin-right: 10px;" id="car_cjh_'+carLength;
		 carsHtml += '"/></div>';
		 $('#carsDiv').append(carsHtml);
	});
	
	//增加汽车信息
	$("#a_delCars").click(function(){
		var item = $("#carsDiv > div");
		if(item && item.length > 0){
			$('div').remove('#carItem_'+item.length);
		}
	});
	
	//增加担保人
	$("#a_addDbr").click(function(){
		 var item = $("#dbrDiv > div");
		 var dbrLength = item.length + 1;
		 var dbrHtml = '<div id="dbrItem_'+ dbrLength +'" class="item" carsDiv="carsDiv"><label style="margin-right:23px"><i>&nbsp;&nbsp;</i>担保人(个人)&nbsp;&nbsp;：</label>&nbsp;姓名：<input type="text" maxlength=20 style="width:60px;margin-left: 0px;margin-right: 10px;" id="dbr_xm_' + dbrLength;
		 dbrHtml += '"/>&nbsp;身份证号：<input type="text" maxlength=18 style="width:130px;margin-left: 0px;margin-right: 10px;" id="dbr_sfzh_'+dbrLength;
		 dbrHtml += '"/>&nbsp;联系电话：<input type="text" maxlength=11 style="width:80px;margin-left: 0px;margin-right: 10px;" id="dbr_lxdh_'+dbrLength;
		 dbrHtml += '"/>&nbsp;住所：<input type="text" maxlength=30 style="width:300px;margin-left: 0px;margin-right: 10px;" id="dbr_zs_'+dbrLength;
		 dbrHtml += '"/></div>';
		 $('#dbrDiv').append(dbrHtml);
	});
	
	$("#a_delDbr").click(function(){
		var item = $("#dbrDiv > div");
		if(item && item.length > 0){
			$('div').remove('#dbrItem_'+item.length);
		}
	});
	
	
	//提交修改数据
	$("#saveInfoBtn").click(function(){
		
		if("" == $("#loanUserName").val()){
			$.popTips("popTipErr","借款人姓名不能为空");
			return;
		}
		if("" == $("#loanUserCardId").val()){
			$.popTips("popTipErr","借款人身份证号不能为空");
			return;
		}
		if("" == $("#loanAmount").val()){
			$.popTips("popTipErr","借款金额不能为空");
			return;
		}
		if("" == $("#rateByMonth").val()){
			$.popTips("popTipErr","借款利率不能为空");
			return;
		}
		/* if("" == $("#rateBySynthesize").val()){
			 $.popTips("popTipErr","综合利率不能为空");
			return;
		} */
		if($("#loanTypeForUser").val()=="企业用户"){
			if(""==$("#legalUserCardId").val()){
				$.popTips("popTipErr","借款用户未企业用户，法人的身份证号不能为空");
				return;
			}
		}
		/* if(parseFloat($("#rateBySynthesize").val())<parseFloat($("#rateByMonth").val())){
			$.popTips("popTipErr","综合利率不能小于借款利率");
			return;
		} */
		if("" == $("#limit").val()){
			$.popTips("popTipErr","借款期限不能为空");
			return;
		}
		
		var transferUserNo = $("#transferFirstUser").attr("transferUserNo");
		var refundType = $("#spanFirstRefund").attr("refundType");
		var product = $("#spanFirstProduct").attr("product");
		var loanDate = $("#loanDate").val().replaceAll('-',"");
		var loanAmount = $("#loanAmount").val()*10*10;
		var rateByMonth = ($("#rateByMonth").val()*10*10).toFixed(0);//借款利率
		var rateBySynthesize=($("#rateBySynthesize").val()*10*10).toFixed(0);//综合利率
		var templateType = $("#spanTemplateType").attr("templateType");
		
		var sumFinancingMoney = $("#sumFinancingMoney").val()*10*10;
		var financingMoney = $("#financingMoney").val()*10*10;
		var fee = $("#fee").val()*10*10;
		var guaranteeFee = $("#guaranteeFee").val()*10*10;
		var incidentals = $("#incidentals").val()*10*10;
		/* var detailMoney = $("#detailMoney").val()*10*10; */
		var otherMoney = $("#otherMoney").val()*10*10;
		
		
		
		
		//汽车信息
		var cars = "";
		var p = $("#car_pp").val();
		var x = $("#car_xh").val();
		var c = $("#car_cph").val();
		var f = $("#car_fdjh").val();
		var cjh = $("#car_cjh").val();
		if(p && "" !=p && x && "" !=x && c && "" !=c && f && "" !=f && cjh && "" !=cjh){
			cars = p + "|" + x + "|" + c + "|" + f + "|" + cjh + "," ;
		} else if(p && "" !=p &&( !x || "" ==x || !c || "" ==c || !f || "" ==f || !cjh || "" ==cjh)){
			alert("车辆信息填写不完整\n（若无车辆则不填）");
			return;
		} 
		var item = $("#carsDiv > div");
		for (var i = 1; i <= item.length; i++) {
			var pp = $("#car_pp_"+i).val();
			var xh = $("#car_xh_"+i).val();
			var cph = $("#car_cph_"+i).val();
			var fdjh = $("#car_fdjh_"+i).val();
			var cjh = $("#car_cjh_"+i).val();
			if(pp && "" !=pp && xh && "" !=xh && cph && "" !=cph && fdjh && "" !=fdjh && cjh && "" !=cjh){
				cars += pp + "|";
				cars += xh + "|";
				cars += cph + "|";
				cars += fdjh + "|";
				cars += cjh;
				if(i < item.length){
					cars += ","
				}
			} else if(pp && "" !=pp &&( !xh || "" ==xh || !cph || "" ==cph || !fdjh || "" ==fdjh || !cjh || "" ==cjh)){
				alert("车辆信息填写不完整\n（若无车辆则不填）");
				return;
			} 
		}
		
		//担保人(个人)
		var dbrs = "";
		var dbr_xm = $("#dbr_xm").val();
		var dbr_sfzh = $("#dbr_sfzh").val();
		var dbr_lxdh = $("#dbr_lxdh").val();
		var dbr_zs = $("#dbr_zs").val();
		if(dbr_xm && "" != dbr_xm){
			if("" == dbr_sfzh){
				dbr_sfzh = " ";
			}
			if("" == dbr_lxdh){
				dbr_lxdh = " ";
			}
			if("" == dbr_zs){
				dbr_zs = " ";
			}
			dbrs = dbr_xm + "|" + dbr_sfzh + "|" + dbr_lxdh + "|" + dbr_zs + "," ;
		}
		var item = $("#dbrDiv > div");
		for (var i = 1; i <= item.length; i++) {
			var dbr_xm_a = $("#dbr_xm_"+i).val();
			var dbr_sfzh_a = $("#dbr_sfzh_"+i).val();
			var dbr_lxdh_a = $("#dbr_lxdh_"+i).val();
			var dbr_zs_a = $("#dbr_zs_"+i).val();
			
			if("" != dbr_xm_a){
				if("" == dbr_sfzh_a){
					dbr_sfzh_a = " ";
				}
				if("" == dbr_lxdh_a){
					dbr_lxdh_a = " ";
				}
				if("" == dbr_zs_a){
					dbr_zs_a = " ";
				}
				dbrs += dbr_xm_a + "|" + dbr_sfzh_a + "|" + dbr_lxdh_a + "|" + dbr_zs_a;
				if(i < item.length){
					dbrs += ","
				}
			}
		}
		
		if(transferUserNo!=null){
			$("input[name='transferUserNo']").val(transferUserNo);//债权人编号
		}
		$("input[name='transferUserName']").val($("#transferUser").val());//债权人姓名
		$("input[name='contractsNum']").val($("#contractsNum").val());//合同编号
		$("input[name='loanUserName']").val($("#loanUserName").val());//借款人姓名
		$("input[name='loanUserCardId']").val($("#loanUserCardId").val());//借款人身份证号
		$("input[name='loanUserAddress']").val($("#loanUserAddress").val());//借款人家庭住址
		$("input[name='loanUserMobile']").val($("#loanUserMobile").val());//借款人手机号
		
		//$("input[name='emergencyName']").val($("#emergencyName").val());
		//$("input[name='emergencyRelation']").val($("#emergencyRelation").val());
		//$("input[name='emergencyMobile']").val($("#emergencyMobile").val());
		
		$("input[name='loanAmount']").val(loanAmount);//借款金额
		$("input[name='rateByMonth']").val(rateByMonth);//借款利率
		$("input[name='rateBySynthesize']").val(rateBySynthesize);//借款利率
		$("input[name='loanUsed']").val($("#loanUsed").val());//借款用途
		$("input[name='limit']").val($("#limit").val());//借款期限
		$("input[name='refundType']").val(refundType);
		$("input[name='cars']").val(cars);
		//$("input[name='loanBankUserName']").val($("#loanBankUserName").val());
		$("input[name='loanBankNo']").val($("#loanBankNo").val());//银行卡卡号
		$("input[name='loanBankName']").val($("#loanBankName").val());//银行卡全称
		$("input[name='loanDate']").val(loanDate);//签订时间
		$("input[name='product']").val(product);
		$("input[name='dbrs']").val(dbrs);
		$("input[name='templateType']").val(templateType);//合同类型
		$("input[name='addressSign']").val($("#addressSign").val());//合同签署地
		$("input[name='court']").val($("#court").val());//合同签署地法院
		
		$("input[name='ensureCompanyName']").val($("#ensureCompanyName").val());//担保人姓名(公司)
		$("input[name='companyCode']").val($("#companyCode").val());//担保人公司组织机构代码(公司)
		$("input[name='businessPlace']").val($("#businessPlace").val());//担保人经营场所(公司)
		$("input[name='companyPhone']").val($("#companyPhone").val());//担保人联系电话(公司)
		$("input[name='companyAddress']").val($("#companyAddress").val());//收车费用标准
		
		$("input[name='serveMobile']").val($("#serveMobile").val());//客服专号
		$("input[name='moneyLoan']").val($("#moneyLoan").val());//现金支付
		
		$("input[name='sumFinancingMoney']").val(sumFinancingMoney);
		$("input[name='financingMoney']").val(financingMoney);
		$("input[name='fee']").val(fee);
		$("input[name='guaranteeFee']").val(guaranteeFee);
		$("input[name='incidentals']").val(incidentals);
		/* $("input[name='detailMoney']").val(detailMoney); */
		$("input[name='otherMoney']").val(otherMoney);
		$("input[name='entrustPersonName']").val($("#entrustPersonName").val());
		$("input[name='rateByService']").val(($("#rateByService").val()*10*10).toFixed(0));//月服务费率 
		$("input[name='legalUserCardId']").val($("#legalUserCardId").val());//法人身份证 
		$("input[name='loanTypeForUser']").val($("#loanTypeForUser").val());//用户类型 
	
		//表单提交
		 YRHX.ajax({
			   url:"/addContracts",
			   data: $("#vehicleForm").serialize(),
			   success:function(sucData){
				   alert("添加合同成功");
				   window.location.href="contractsFullPDF?contractsNum="+sucData;
			   },
			   error:function(data){
				   alert(data.return_info||"添加失败");
			   }
		   }); 
	});
</script>
</body>
</html>